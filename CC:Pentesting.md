# CC:Pentesting Write-Up

A TryHackMe beginner level room, which provides an introduction to various tools and concepts commonly encountered in penetration testing

## Deploy the machine
Turn on OpenVPN on your machine to connect to corresponding server

If you don't have OpenVPN, then go download it and type 'sudo openvpn <OpenVPN_filename>' in terminal

## [Section 1 - Network Utilities] - nmap

nmap = 'Network Mapper'

nmap -> allows a pen tester to see which ports are open, and information about which services are running on those ports

```language
-p : specify which ports to scan
-sn: ping scan
-sU: UDP scan
-sC: run default scripts
-sV: show versions of services
-A : aggressive mode (enable OS detection, version detection, script scanning and traceroute)
-O : enable OS detection
```

### 1. How many ports are open on the machine?
```bash
	nmap -sC -sV -oN <IP_Address>
```
#### answer: 1

### 2. What service is running on the machine?
refer to information above
#### answer: Apache

### 3. What is the version of the service?
refer to information above
#### answer: 2.4.18

### 4. What is the output of the http-title script(included in default scripts)?
refer to information above
#### answer: Apache2 Ubuntu Default Page: It Works


## [Section 1 - Network Utilities] - Netcat

nc -> allow users to connect to specific ports and send and receive data

Types of shells

1: Bind Shell
A type of shell in which the target machine opens up a communication port or a listener on the victim machine and waits for an incoming connection. The attacker then connects to the victim machineâ€™s listener which then leads to code or command execution on the server.

2: Reverse Shell
A type of shell in which the target machine communicates back to the attacking machine. The attacking machine has a listener port on which it receives the connection, which by using, code or command execution is achieved.

```language
-l : listen for connections
-v : enable verbose mode (allow you to see who connected to you)
-p : specify a port to listen on
-e : specify which porgram to execute after connecting to a host
-u : UDP mode
```


## [Section 2 - Web Enumeration] - gobuster

gobuster -> try to find valid directories from a wordlist of possible directories, as well as valid subdomains

<Commands>

```language
dir: use directory/file enumeration mode
dns: use DNS subdomain enumeration mode
fuzz: use fuzzing mode
s3 : use aws bucket enumeration mode
version: show the current version
vhost: use VHOST enumeration mode
```

<Flags>

```language
  -f, --add-slash                     Append / to each request
  -c, --cookies string                Cookies to use for the requests
  -e, --expanded                      Expanded mode, print full URLs
  -x, --extensions string             File extension(s) to search for
  -r, --follow-redirect               Follow redirects
  -H, --headers stringArray           Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'
  -h, --help                          help for dir
  -l, --include-length                Include the length of the body in the output
  -k, --no-tls-validation             Skip TLS certificate verification
  -n, --no-status                     Don't print status codes
  -P, --password string               Password for Basic Auth
  -p, --proxy string                  Proxy to use for requests [http(s)://host:port]
  -s, --status-codes string           Positive status codes (will be overwritten with status-codes-blacklist if set) (default "200,204,301,302,307,401,403")
  -b, --status-codes-blacklist string Negative status codes (will override status-codes if set)
      --timeout duration              HTTP Timeout (default 10s)
  -u, --url string                    The target URL
  -a, --useragent string              Set the User-Agent string (default "gobuster/3.1.0")
  -U, --username string               Username for Basic Auth
  -d, --discover-backup               Upon finding a file search for backup files
      --wildcard                      Force continued operation when wildcard found
```

<Global Flags>

```language
  -z, --no-progress       Don't display progress
  -o, --output string     Output file to write results to (defaults to stdout)
  -q, --quiet             Don't print the banner and other noise
  -t, --threads int       Number of concurrent threads (default 10)
      --delay duration    Time each thread waits between requests (e.g. 1500ms)
  -v, --verbose           Verbose output (errors)
  -w, --wordlist string   Path to the wordlist
```


### 1. How to find a hidden directory?

```bash
  	gobuster dir -u http://<IP_ADDRESS> -w /usr/share/wordlists/dirb/common.txt -t 64
```
#### Answer: secret

### 2. How to find a hidden directory with the extension xxa?

```bash
  	gobuster dir -u http://<IP_ADDRESS> -w /usr/share/wordlists/dirb/common.txt -x xxa -t 64 -q
```
#### Answer: password


## [Section 2 - Web Enumeration] - nikto

nikto -> allow user to find common vulnerabilities. Commonly used to check for CVE's and general information about web server

```language
       -config+            Use this config file
       -Display+           Turn on/off display outputs
       -dbcheck            check database and other key files for syntax errors
       -Format+            save file (-o) format
       -Help               Extended help information
       -host+              target host/URL
       -id+                Host authentication to use, format is id:pass or id:pass:realm
       -list-plugins       List all available plugins
       -output+            Write output to this file
       -nossl              Disables using SSL
       -no404              Disables 404 checks
       -Plugins+           List of plugins to run (default: ALL)
       -port+              Port to use (default 80)
       -root+              Prepend root value to all requests, format is /directory
       -ssl                Force ssl mode on port
       -Tuning+            Scan tuning
       -timeout+           Timeout for requests (default 10 seconds)
       -update             Update databases and plugins from CIRT.net
       -Version            Print plugin and database versions
       -vhost+             Virtual host (for Host header)
                + requires a value
```
refer to this information above to answer the questions


## [Section 3 - Metasploit] - 


## [Section 4 - Hash Cracking] - Salting and Formatting

- Every hash has the exact same format

- Salts are typically appended onto the hash with a colon and the salt

A salt is random data that is used as an additional input to a one-way function that hashes data, a password or passphrase


## [Section 4 - Hash Cracking] - Hashcat

Hashcat -> a hash cracking tool

- It does not have auto detection for hashtypes, instead it has modes. You use different modes depending on what type of hashes you are trying to crack. For example, mode 0 would be used for a md5 hash and mode 100 for a SHA1 hash.

### 1. What flag sets the mode?
To see flags, type netcat -h
#### Answer: -m

### 2. What flag sets the "attack mode"?
To see flags, type netcat -h
#### Answer: -a

### 3. What is the attack mode number for Brute-force?
To see attack mode number, type netcat -h
#### Answer: 3

### 4. What is the mode number for SHA3-512?
To see mode numbers, type netcat -h
#### Answer: 17600

### 5. Crack This Hash:56ab24c15b72a457069c5ea42fcfc640 Type: MD5
You can look it up on google and find website that helps to crack any type of hashes.
#### Answer: happy

### 6. Crack This Hash:4bc9ae2b9236c2ad02d81491dcb51d5f Type: MD4
You can look it up on google and find website that helps to crack any type of hashes.
#### Answer: nootnoot


## [Section 4 - Hash Cracking] - John The Ripper

jtr -> a free password cracking software tool
It supports numerous formats of hashes and is extremely easy to use, while having a lot of options for customization. 

```language
--single[=SECTION[,..]]    "single crack" mode, using default or named rules
--single=:rule[,..]        same, using "immediate" rule(s)
--wordlist[=FILE] --stdin  wordlist mode, read words from FILE or stdin
                  --pipe   like --stdin, but bulk reads, and allows rules
--loopback[=FILE]          like --wordlist, but extract words from a .pot file
--dupe-suppression         suppress all dupes in wordlist (and force preload)
--prince[=FILE]            PRINCE mode, read words from FILE
--encoding=NAME            input encoding (eg. UTF-8, ISO-8859-1). See also
                           doc/ENCODINGS and --list=hidden-options.
--rules[=SECTION[,..]]     enable word mangling rules (for wordlist or PRINCE
                           modes), using default or named rules
--rules=:rule[;..]]        same, using "immediate" rule(s)
--rules-stack=SECTION[,..] stacked rules, applied after regular rules or to
                           modes that otherwise don't support rules
--rules-stack=:rule[;..]   same, using "immediate" rule(s)
--incremental[=MODE]       "incremental" mode [using section MODE]
--mask[=MASK]              mask mode using MASK (or default from john.conf)
--markov[=OPTIONS]         "Markov" mode (see doc/MARKOV)
--external=MODE            external mode or word filter
--subsets[=CHARSET]        "subsets" mode (see doc/SUBSETS)
--stdout[=LENGTH]          just output candidate passwords [cut at LENGTH]
--restore[=NAME]           restore an interrupted session [called NAME]
--session=NAME             give a new session the NAME
--status[=NAME]            print status of a session [called NAME]
--make-charset=FILE        make a charset file. It will be overwritten
--show[=left]              show cracked passwords [if =left, then uncracked]
--test[=TIME]              run tests and benchmarks for TIME seconds each
--users=[-]LOGIN|UID[,..]  [do not] load this (these) user(s) only
--groups=[-]GID[,..]       load users [not] of this (these) group(s) only
--shells=[-]SHELL[,..]     load users with[out] this (these) shell(s) only
--salts=[-]COUNT[:MAX]     load salts with[out] COUNT [to MAX] hashes
--costs=[-]C[:M][,...]     load salts with[out] cost value Cn [to Mn]. For
                           tunable cost parameters, see doc/OPTIONS
--save-memory=LEVEL        enable memory saving, at LEVEL 1..3
--node=MIN[-MAX]/TOTAL     this node's number range out of TOTAL count
--fork=N                   fork N processes
--pot=NAME                 pot file to use
--list=WHAT                list capabilities, see --list=help or doc/OPTIONS
--format=NAME              force hash of type NAME. The supported formats can
                           be seen with --list=formats and --list=subformats
```

### 1. What flag let's you specify which wordlist to use?  
refer to information above
#### answer: -wordlist

### 2. What flag lets you specify which hash format(Ex: MD5,SHA1 etc.) to use?
refer to information above
#### answer: --format

### 3. How do you specify which rule to use?
refer to information above
#### answer: --rules

### 4. Crack this hash:5d41402abc4b2a76b9719d911017c592 Type: MD5
```bash
	echo 5d41402abc4b2a76b9719d911017c592 > hash.txt
	john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 hash1.txt
```
#### answer: Hello

### 5. Crack this hash:5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8 Type: SHA1
```bash
	echo 5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8 > hash.txt
	john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-sha1 hash.txt
```
#### answer: password


## [Section 5 - SQL Injection] - sqlmap

sqlmap -> an automated SQL injection tool used to check for various types of injections

### 1. How do you specify which url to check?
To see flags, type sqlmap -h
#### Answer: -u

### 2. What about which google dork to use?
To see flags, type sqlmap -h
#### Answer: -g

### 3. How do you select(lol) which parameter to use?
To see flags, type sqlmap -h
#### Answer: -p

### 4. What flag sets which database is in the target host's backend?
To see flags, type sqlmap -h
#### Answer: --dbms

### 5. How do you select the level of depth sqlmap should use?
To see flags, type sqlmap -h
#### Answer: --level

### 6. How do you dump the table entries of the database?
To see flags, type sqlmap -h
#### Answer: --dump

### 7. Which flag sets which db to enumerate? (Case sensitive)
To see flags, type sqlmap -h
#### Answer: -D

### 8. Which flag sets which table to enumerate? (Case sensitive)
To see flags, type sqlmap -h
#### Answer: -T

### 9. Which flag sets which column to enumerate?(Case sensitive)
To see flags, type sqlmap -h
#### Answer: -C

### 10. How do you ask sqlmap to try to get an interactive os-shell?
To see flags, type sqlmap -h
#### Answer: -os-shell

### 11. What flag dumps all data from every table?
To see flags, type sqlmap -h
#### Answer: -dump-all


## [Section 5 - SQL Injection] - Vulnerable Web Application

### 1. Set the url to the machine ip, and run the command
```bash
  sqlmap -u http://<IP_Address> 
```

### 2. How many types of sqli is the site vulnerable to?
#### Answer: 3

### 3. Dump the database.
```bash
  sqlmap -u http://<IP_Address> --forms --dump 
```

### 4. What is the name of the database?
#### Answer: tests

### 5. How many tables are in the database?
#### Answer: 2

### 6. What is the value of the flag?
#### Answer: found_me


## [Section 6 - Samba] - smbmap

smbmap -> allow pen-testers to run commands, download and upload files and help for smb enumeration

```language
Main arguments:
  -H HOST               IP of host
  --host-file FILE      File containing a list of hosts
  -u USERNAME           Username, if omitted null session assumed
  -p PASSWORD           Password or NTLM hash
  -s SHARE              Specify a share (default C$), ex 'C$'
  -d DOMAIN             Domain name (default WORKGROUP)
  -P PORT               SMB port (default 445)
  -v                    Return the OS version of the remote host
  --admin               Just report if the user is an admin

  File Content Search:
    Options for searching the content of files (must run as root)

    -F PATTERN            File content search, -F '[Pp]assword' (requires admin access to execute commands, and PowerShell on victim host)
    --search-path PATH    Specify drive/path to search (used with -F, default C:\Users), ex 'D:\HR\'
    --search-timeout TIMEOUT
                          Specifcy a timeout (in seconds) before the file search job gets killed. Default is 300 seconds.

  Filesystem interaction:
    Options for interacting with the specified host's filesystem

    --download PATH       Download a file from the remote system, ex.'C$\temp\passwords.txt'
    --upload SRC DST      Upload a file to the remote system ex. '/tmp/payload.exe C$\temp\payload.exe'
    --delete PATH TO FILE
                          Delete a remote file, ex. 'C$\temp\msf.exe'
    --skip                Skip delete file confirmation prompt
```

### 1. How do you set the username to authenticate with?
Refer to information above
#### Answer: -u

### 2. What about the password?    
Refer to information above
#### Answer: -p

### 3. How do you set the host?
Refer to information above
#### Answer: -H

### 4. What flag runs a command on the server(assuming you have permissions that is)?
Refer to information above
#### Answer: -x

### 5. How do you specify the share to enumerate??
Refer to information above
#### Answer: -s

### 6. How do you set which domain to enumerate?
Refer to information above
#### Answer: -d

### 7. What flag downloads a file?
Refer to information above
#### Answer: --download

### 8. What about uploading one?
Refer to information above
#### Answer: --upload

### 9. Given the username "admin", the password "password", and the ip "10.10.10.10", how would you run ipconfig on that machine?
```bash
  smbmap -u "admin" -p "password" -H 10.10.10.10 -x "ipconfig"
```


## [Section 6 - Samba] - smbclient

smbclient -> allow you to do most of the things you can do with smbmap, and it also offers you and interactive prompt

```language
  Usage: smbclient service <password>
  -R, --name-resolve=NAME-RESOLVE-ORDER     Use these name resolution services only
  -M, --message=HOST                        Send message
  -I, --ip-address=IP                       Use this IP to connect to
  -E, --stderr                              Write messages to stderr instead of stdout
  -L, --list=HOST                           Get a list of shares available on a host
  -m, --max-protocol=LEVEL                  Set the max protocol level
  -T, --tar=<c|x>IXFvgbNan                  Command line tar
  -D, --directory=DIR                       Start from directory
  -c, --command=STRING                      Execute semicolon separated commands
  -b, --send-buffer=BYTES                   Changes the transmit/send buffer
  -t, --timeout=SECONDS                     Changes the per-operation timeout
  -p, --port=PORT                           Port to connect to
  -g, --grepable                            Produce grepable output
  -q, --quiet                               Suppress help message
  -B, --browse                              Browse SMB servers using DNS

Help options:
  -?, --help                                Show this help message
      --usage                               Display brief usage message

Common samba options:
  -d, --debuglevel=DEBUGLEVEL               Set debug level
  -s, --configfile=CONFIGFILE               Use alternate configuration file
  -l, --log-basename=LOGFILEBASE            Base name for log files
  -V, --version                             Print version
      --option=name=value                   Set smb.conf option from command line

Connection options:
  -O, --socket-options=SOCKETOPTIONS        socket options to use
  -n, --netbiosname=NETBIOSNAME             Primary netbios name
  -W, --workgroup=WORKGROUP                 Set the workgroup name
  -i, --scope=SCOPE                         Use this Netbios scope

Authentication options:
  -U, --user=USERNAME                       Set the network username
  -N, --no-pass                             Don't ask for a password
  -k, --kerberos                            Use kerberos (active directory) authentication
  -A, --authentication-file=FILE            Get the credentials from a file
  -S, --signing=on|off|required             Set the client signing state
  -P, --machine-pass                        Use stored machine account password
  -e, --encrypt                             Encrypt SMB transport
  -C, --use-ccache                          Use the winbind ccache for authentication
      --pw-nt-hash                          The supplied password is the NT hash
```

### 1. How do you specify which domain(workgroup) to use when connecting to the host?
Refer to information above
#### Answer: -w

### 2. How do you specify the ip address of the host?
Refer to information above
#### Answer: -I

### 3. How do you run the command "ipconfig" on the target machine?
Refer to information above
#### Answer: -c "ipconfig"

### 4. How do you specify the username to authenticate with?
Refer to information above
#### Answer: -U

### 5. How do you specify the password to authenticate with?
Refer to information above
#### Answer: -P

### 6. What flag is set to tell smbclient to not use a password?
Refer to information above
#### Answer: -N

### 7. While in the interactive prompt, how would you download the file test, assuming it was in the current directory?
Refer to information above
#### Answer: get test

### 8. In the interactive prompt, how would you upload your /etc/hosts file
Refer to information above
#### Answer: put /etc/hosts


## [Section 7] - Final Exam

### 1. What is the user.txt?

```bash
  gobuster dir -u http://<IP_ADDRESS> -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x .txt -t 64 -q
  go to http://<IP_Address>/secret/secret.txt
  hash-identifier 046385855FC9580393853D8E81F240B66FE9A7B8
  john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-sha1 hi.hash
  ssh nyan@<IP_Address>
```

#### Answer: supernootnoot

### 2. What is the root.txt?

```bash
  sudo -l
  sudo /bin/su 
  id 
  cat /root/root.txt
```

#### Answer: congratulations!!!!